{"id": "334", "type": "class", "data": "{\"code_str\": \"class FloatiesIndicator:\\n    def __init__(self):\\n        self.floaties = world.apps['Floaties']\\n        self.floaties.changed.connect(self.floaties_changed)\\n        self.button = z.ContextButton(\\n            label='0', color=world.themes.theme.blue[500],\\n            foreground_color=world.themes.theme.gray[900],\\n            actions=[\\n                ('kill', self.kill_triggered),\\n                ('kill all', self.kill_all_triggered),\\n            ],\\n            hud=True,\\n            focusable=False\\n        )\\n        world.apps['Hud'].top_panel.add(self.button)\\n\\n        self.kill_state = world.states.create_state(name='floaties-kill',\\n                                                    on_enter=self.on_enter_kill_state,\\n                                                    on_leave=self.on_leave_kill_state)\\n\\n    def mouse_button_kill(self, button, action, mods):\\n        if button == sdl2.SDL_BUTTON_LEFT and action == 0:\\n            intersector = z.ScreenPosObjectsIntersector(\\n                world.window.mouse_pos, mapattr(self.floaties.floaties.values(), 'layout'))\\n            if intersector.nearest_hit:\\n                floatie = one([x for x in self.floaties.floaties.values()\\n                           if x.layout == intersector.nearest_hit.obj])\\n                world.floaties.drop_obj(floatie.obj)\\n            world.states.transit_back()\\n\\n    def keyboard_kill(self, key, scancode, action, mods):\\n        if action == 1 and mods == 0:\\n            if key == sdl2.SDLK_ESCAPE:\\n                world.states.transit_back()\\n            elif key == sdl2.SDLK_x:\\n                world.states.transit_back()\\n                current_root_children = [x for x in world.floaties.floaties.keys()\\n                                         if x.focus.has_current_descendant()]\\n                if current_root_children:\\n                    world.floaties.drop_obj(one(current_root_children))\\n\\n    def on_enter_kill_state(self):\\n        world.window.mouse_button.connect(self.mouse_button_kill)\\n        world.window.keyboard.connect(self.keyboard_kill)\\n\\n    def on_leave_kill_state(self):\\n        world.window.mouse_button.disconnect(self.mouse_button_kill)\\n        world.window.keyboard.disconnect(self.keyboard_kill)\\n\\n    def kill_triggered(self):\\n        world.states.transit(self.kill_state)\\n\\n    def kill_all_triggered(self):\\n        self.floaties.drop_all()\\n\\n    def floaties_changed(self):\\n        self.button.set_label(f'{len(self.floaties.floaties.keys())}')\\n\\n    def drop(self):\\n        world.states.drop_state(self.kill_state)\\n        self.button.drop()\\n\", \"name\": \"FloatiesIndicator\"}", "created_at": null, "updated_at": 1754736945.5018373}