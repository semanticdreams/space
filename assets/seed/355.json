{"id": "355", "type": "class", "data": "{\"code_str\": \"from OpenGL.GL import *\\n\\n\\nclass Renderers:\\n    def __init__(self):\\n        self.sub_worlds = []\\n\\n        self.text_renderer = z.TextRenderer()\\n        self.scene_text_vectors = {}\\n        self.hud_text_vectors = {}\\n\\n        self.triangle_renderer = z.TriangleRenderer()\\n        self.scene_triangle_vector = z.Vector()\\n        self.hud_triangle_vector = z.Vector()\\n\\n        self.line_renderer = z.LineRenderer()\\n        self.line_vector = z.Vector()\\n\\n        self.line_strips = []\\n\\n        self.skybox_renderer = z.SkyboxRenderer()\\n\\n        self.pics = z.Pics()\\n        self.points = z.Points()\\n        self.meshes = z.Meshes()\\n\\n        self.lua_world = z.LuaWorld()\\n\\n        self.fxaa = z.Fxaa()\\n\\n        self.create_final_fbo()\\n\\n        world.renderers = self\\n\\n    def viewport_changed(self, viewport):\\n        glDeleteFramebuffers(1, self.final_fbo)\\n        glDeleteRenderbuffers(1, self.final_rbo)\\n        self.create_final_fbo()\\n        self.lua_world.viewport_changed(viewport)\\n\\n    def create_final_fbo(self):\\n        width, height = world.viewport.value[2:4]\\n        self.final_fbo = glGenFramebuffers(1)\\n        glBindFramebuffer(GL_FRAMEBUFFER, self.final_fbo)\\n        self.final_rbo = glGenRenderbuffers(1)\\n        glBindRenderbuffer(GL_RENDERBUFFER, self.final_rbo)\\n        glRenderbufferStorage(GL_RENDERBUFFER, GL_RGBA8, width, height)\\n        glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_RENDERBUFFER, self.final_rbo)\\n        assert glCheckFramebufferStatus(GL_FRAMEBUFFER) == GL_FRAMEBUFFER_COMPLETE\\n        glBindFramebuffer(GL_FRAMEBUFFER, 0)\\n\\n    def get_hud_text_vector(self, font):\\n        if font not in self.hud_text_vectors:\\n            self.hud_text_vectors[font] = z.Vector()\\n        return self.hud_text_vectors[font]\\n\\n    def get_scene_text_vector(self, font):\\n        if font not in self.scene_text_vectors:\\n            self.scene_text_vectors[font] = z.Vector()\\n        return self.scene_text_vectors[font]\\n\\n    def render(self):\\n        for sub_world in self.sub_worlds:\\n            sub_world.prerender()\\n\\n        glBindFramebuffer(GL_FRAMEBUFFER, self.fxaa.fbo)\\n        glEnable(GL_DEPTH_TEST)\\n        glDepthFunc(GL_LESS)\\n        glClearColor(*world.window.clear_color)\\n        glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT)\\n\\n        view = world.camera.camera.get_view_matrix()\\n\\n        self.skybox_renderer.render()\\n\\n        self.triangle_renderer.render(world.camera['default'].get_view_matrix(),\\n                                      world.projection.value,\\n                                      self.scene_triangle_vector.array,\\n                                      world.camera['default'].position)\\n        #world.scroll.update()\\n\\n        self.pics.render(view, world.projection.value)\\n\\n        self.line_renderer.render_lines(view,\\n                                        world.projection.value, self.line_vector.array)\\n        self.line_renderer.render_line_strips(view,\\n                                              world.projection.value,\\n                                              [x.vector.array for x in self.line_strips])\\n\\n        self.points.render(view, world.projection.value)\\n        self.meshes.render(view, world.projection.value)\\n\\n        for sub_world in self.sub_worlds:\\n            sub_world.render(view, world.projection.value)\\n\\n        self.lua_world.render(view, world.projection.value)\\n\\n        glBindFramebuffer(GL_FRAMEBUFFER, self.final_fbo)\\n        glDisable(GL_DEPTH_TEST)\\n        glClear(GL_COLOR_BUFFER_BIT)\\n        self.fxaa.render()\\n\\n        glFramebufferRenderbuffer(GL_FRAMEBUFFER, GL_DEPTH_ATTACHMENT, GL_RENDERBUFFER, self.fxaa.rbo)\\n        glEnable(GL_DEPTH_TEST)\\n\\n        for font, vector in self.scene_text_vectors.items():\\n            self.text_renderer.render(world.camera['default'].get_view_matrix(),\\n                                      world.projection.value,\\n                                      vector.array, font)\\n\\n        self.triangle_renderer.render(world.camera['identity'].get_view_matrix(),\\n                                      world.hud_projection.value,\\n                                      self.hud_triangle_vector.array,\\n                                      world.camera['identity'].position)\\n\\n        for font, vector in self.hud_text_vectors.items():\\n            self.text_renderer.render(world.camera['identity'].get_view_matrix(),\\n                                      world.hud_projection.value,\\n                                      vector.array, font)\\n\\n        glBindFramebuffer(GL_READ_FRAMEBUFFER, self.final_fbo)\\n        glBindFramebuffer(GL_DRAW_FRAMEBUFFER, 0)\\n        glBlitFramebuffer(0, 0, world.viewport.value[2], world.viewport.value[3],\\n                          0, 0, world.viewport.value[2], world.viewport.value[3],\\n                          GL_COLOR_BUFFER_BIT, GL_NEAREST)\\n\\n    def drop(self):\\n        pass\\n\", \"name\": \"Renderers\"}", "created_at": null, "updated_at": 1756754129.7279844}