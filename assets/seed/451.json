{"id": "451", "type": "class", "data": "{\"code_str\": \"class CodeEntity(z.Entity):\\n    def __init__(self, id, code_str, lang='py', name='', kernel=None, summary=None, project_id=1, autolaunch=0, archived_at=None, launchable=0):\\n        self.code_str = code_str\\n        self.lang = lang\\n        self.name = name\\n        self.kernel = kernel\\n        self.summary = summary\\n        self.project_id = project_id\\n        self.autolaunch = autolaunch\\n        self.launchable = launchable\\n        self.archived_at = archived_at\\n        super().__init__('code', id)\\n        self.label = self.name or self.code_str\\n\\n        self.view = z.CodeEntityView\\n        self.preview = z.CodeEntityPreview\\n        self.color = (0.5, 0.3, 0.1, 1)\\n\\n    @classmethod\\n    def all(cls):\\n        return world.apps['Entities'].get_entities('code')\\n\\n    @classmethod\\n    def create(cls, project_id=1, code_str='', lang='py', name='', kernel=0, summary=None,\\n               autolaunch=0, launchable=0, id=None):\\n        data = {\\n            'code_str': code_str,\\n            'name': name,\\n            'lang': lang,\\n            'project_id': project_id,\\n            'kernel': kernel,\\n            'summary': summary,\\n            'autolaunch': autolaunch,\\n            'launchable': launchable,\\n        }\\n        id = super().create('code', data, id=id)\\n        return cls(id, code_str, lang, name, kernel, summary, project_id, autolaunch, launchable=launchable)\\n\\n    @classmethod\\n    def load(cls, id, data):\\n        return cls(id, data['code_str'], data['lang'], data['name'], data['kernel'],\\n                   data['summary'], data['project_id'], data['autolaunch'], launchable=data.get('launchable', 0),\\n                   )\\n\\n    def set_code_str(self, code_str):\\n        self.code_str = code_str\\n\\n    def dump_data(self):\\n        return {\\n            'code_str': self.code_str,\\n            'name': self.name,\\n            'kernel': self.kernel,\\n            'lang': self.lang,\\n            'summary': self.summary,\\n            'project_id': self.project_id,\\n            'autolaunch': self.autolaunch,\\n            'launchable': self.launchable\\n        }\\n\\n    def clone(self):\\n        return CodeEntity.create(\\n            project_id=self.project_id,\\n            code_str=self.code_str,\\n            lang=self.lang,\\n            name=f\\\"Copy of {self.name}\\\" if self.name else \\\"\\\",\\n            kernel=self.kernel,\\n            autolaunch=self.autolaunch,\\n            launchable=self.launchable,\\n        )\\n\\n    def run(self, catch_errors=False, callback=None, registers=None, on_write_out=None, on_write_error=None):\\n        return world.kernels.ensure_kernel(self.kernel).send_code(\\n            self.to_dict(),\\n            callback=callback,\\n            registers=registers,\\n            catch_errors=catch_errors,\\n            on_write_out=on_write_out,\\n            on_write_error=on_write_error\\n        )\\n\\n    def update_summary(self, summary):\\n        self.summary = summary\\n\\n    def archive(self):\\n        self.archived_at = time.time()\\n\\n    def to_dict(self):\\n        return {\\n            'id': self.id,\\n            'code': self.code_str,\\n            'lang': self.lang,\\n            'name': self.name,\\n            'kernel': self.kernel,\\n            'summary': self.summary,\\n            'project_id': self.project_id,\\n            'autolaunch': self.autolaunch,\\n            'launchable': self.launchable,\\n            'archived_at': self.archived_at\\n        }\\n\\n    #@staticmethod\\n    #def grep(query):\\n    #    return list(map(dict, world.db.execute(\\n    #       'select * from codes where code like ? collate nocase',\\n    #        (f'%{query}%',)\\n    #    ).fetchall()))\\n\\n    #@staticmethod\\n    #def get_all():\\n    #    return list(map(dict, world.db.execute(\\n    #        'select * from codes where archived_at is null order by id desc'\\n    #    ).fetchall()))\\n\\n    #@staticmethod\\n    #def run_autolaunch_codes():\\n    #    for code in world.db.execute('select * from codes where autolaunch = 1 and archived_at is null'):\\n    #        code_dict = dict(code)\\n    #        world.kernels.ensure_kernel(code_dict['kernel']).send_code(code_dict)\\n\", \"name\": \"CodeEntity\"}", "created_at": null, "updated_at": 1756754129.7297423}