{"id": "351", "type": "class", "data": "{\"code_str\": \"from OpenGL.GL import *\\nfrom PIL import Image\\nfrom ctypes import sizeof, c_float, c_void_p, c_uint, string_at\\n\\n\\nclass Points:\\n    def __init__(self):\\n        glEnable(GL_PROGRAM_POINT_SIZE)\\n\\n        self.program = world.shaders.build_program(world.shaders.find_shader('point.vert'),\\n                                                   world.shaders.find_shader('point.frag'))\\n\\n        self.vector = z.Vector()\\n        self.needs_buffer_update = True\\n\\n        self.projection_uniform = glGetUniformLocation(self.program, b'projection')\\n        self.view_uniform = glGetUniformLocation(self.program, b'view')\\n\\n        self.vao = glGenVertexArrays(1)\\n        self.vbo = glGenBuffers(1)\\n\\n        glBindVertexArray(self.vao)\\n        glBindBuffer(GL_ARRAY_BUFFER, self.vbo)\\n\\n        glVertexAttribPointer(0, 3, GL_FLOAT, GL_FALSE, 32, ctypes.c_void_p(0))\\n        glEnableVertexAttribArray(0)\\n        glVertexAttribPointer(1, 4, GL_FLOAT, GL_FALSE, 32, ctypes.c_void_p(12))\\n        glEnableVertexAttribArray(1)\\n        glVertexAttribPointer(2, 1, GL_FLOAT, GL_FALSE, 32, ctypes.c_void_p(28))\\n        glEnableVertexAttribArray(2)\\n\\n    def create_point(self, position=(0, 0, 0), color=(1, 0, 0, 1), size=10):\\n        h = self.vector.allocate(8)\\n        v = self.vector.view(h)\\n        v[0:3] = np.asarray(position, float)\\n        v[3:7] = np.asarray(color, float)\\n        v[7] = float(size)\\n        self.needs_buffer_update = True\\n        return h\\n\\n    def update_point(self, h, position=None, color=None, size=None):\\n        v = self.vector.view(h)\\n        if position is not None:\\n            v[0:3] = np.asarray(position, float)\\n        if color is not None:\\n            v[3:7] = np.asarray(color, float)\\n        if size is not None:\\n            v[7] = float(size)\\n        self.needs_buffer_update = True\\n\\n    def destroy_point(self, h):\\n        self.vector.delete(h)\\n        self.needs_buffer_update = True\\n\\n    def drop_point(self, h):\\n        self.destroy_point(h)\\n\\n    def render(self, view, projection):\\n        if self.vector.array.size == 0:\\n            return\\n        glBindVertexArray(self.vao)\\n\\n        if self.needs_buffer_update:\\n            glBindBuffer(GL_ARRAY_BUFFER, self.vbo)\\n            glBufferData(GL_ARRAY_BUFFER, self.vector.array.nbytes, self.vector.array, GL_STATIC_DRAW)\\n            self.needs_buffer_update = False\\n\\n        glUseProgram(self.program)\\n\\n        glUniformMatrix4fv(self.projection_uniform, 1, GL_FALSE, projection)\\n        glUniformMatrix4fv(self.view_uniform, 1, GL_FALSE, view)\\n\\n        glDrawArrays(GL_POINTS, 0, int(len(self.vector.array) / 8))\\n\", \"name\": \"Points\"}", "created_at": null, "updated_at": 1751906432.7419472}