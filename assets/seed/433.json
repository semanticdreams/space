{"id": "433", "type": "class", "data": "{\"code_str\": \"class TagEntityView:\\n    def __init__(self, entity, focus_parent=None):\\n        self.focus = (focus_parent or world.focus).add_child(self)\\n        self.entity = entity\\n\\n        # Actions\\n        self.actions_panel = z.ActionsPanel([\\n            ('copy entity', self.entity.copy),\\n            ('paste target entity', self.paste_target),\\n        ], focus_parent=self.focus)\\n\\n        # Tag input\\n        self.tag_label = z.Label(\\\"Tag:\\\")\\n        self.input = z.Input(self.entity.get_tag() or '', focus_parent=self.focus)\\n        self.input.submitted.connect(self.on_input_submitted)\\n\\n        # Target display\\n        self.target_label = z.Label(\\\"Target:\\\")\\n        if self.entity.target_entity_id is not None:\\n            target = self.entity.get_target_entity()\\n            self.target_preview = target.preview(target, focus_parent=self.focus)\\n        else:\\n            self.target_preview = z.Label('<no target>')\\n\\n        # Layout\\n        self.column = z.Flex([\\n            z.FlexChild(self.actions_panel.layout),\\n            z.FlexChild(self.tag_label.layout),\\n            z.FlexChild(self.input.layout),\\n            z.FlexChild(self.target_label.layout),\\n            z.FlexChild(self.target_preview.layout, flex=1)\\n        ], axis='y', xalign='largest')\\n\\n        self.layout = self.column.layout\\n\\n    def __str__(self):\\n        return str(self.entity)\\n\\n    def on_input_submitted(self):\\n        self.entity.set_tag(self.input.text or None)\\n        self.input.set_text(self.entity.get_tag() or '')\\n\\n    def paste_target(self):\\n        assert Y.register_type == 'entity'\\n        entity = Y.value\\n        self.entity.target_entity_id = entity.id\\n        self.entity.save()\\n\\n        self.target_preview.drop()\\n        self.target_preview = entity.preview(entity, focus_parent=self.focus)\\n        self.column.set_children([\\n            z.FlexChild(self.actions_panel.layout),\\n            z.FlexChild(self.tag_label.layout),\\n            z.FlexChild(self.input.layout),\\n            z.FlexChild(self.target_label.layout),\\n            z.FlexChild(self.target_preview.layout, flex=1)\\n        ])\\n\\n    def drop(self):\\n        self.column.drop()\\n        self.actions_panel.drop()\\n        self.input.drop()\\n        self.tag_label.drop()\\n        self.target_label.drop()\\n        self.target_preview.drop()\\n        self.focus.drop()\\n\\n\", \"name\": \"TagEntityView\"}", "created_at": null, "updated_at": 1751906432.7437282}