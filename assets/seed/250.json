{"id": "250", "type": "class", "data": "{\"code_str\": \"from util import adjust_perceptual_color_brightness, wrap_text\\nclass Button:\\n    def __init__(self, text='', hud=False, focusable=True, focus_parent=world.focus,\\n                 background_color=None,\\n                 centered=True, foreground_color=None, icon=None,\\n                 padding_insets=(1, 0.8), font_scale=2,\\n                 wrap=30, on_click=None, on_right_click=None, on_double_click=None):\\n        self.hud = hud\\n        self.wrap = wrap\\n        self.font_scale = font_scale\\n        self.icon = icon or (text[5:] if text.startswith('icon:') else None)\\n        self.background_color = world.themes.theme.button_background_color if background_color is None else background_color\\n        self.foreground_color = foreground_color or world.themes.theme.button_foreground_color\\n        if on_click is not None:\\n            self.on_click = on_click\\n        if on_right_click is not None:\\n            self.on_right_click = on_right_click\\n        if on_double_click is not None:\\n            self.on_double_click = on_double_click\\n\\n        if self.icon:\\n            self.text = z.TextSpan(\\n                codepoints=[world.apps['Icons'][self.icon]], hud=hud,\\n                style=z.TextStyle(color=self.foreground_color, font=world.apps['Icons'].font, scale=self.font_scale))\\n        else:\\n            self.text = z.Text(\\n                wrap_text(text, wrap) if wrap else text,\\n                hud=hud,\\n                style=z.TextStyle(color=self.foreground_color, scale=self.font_scale)\\n            )\\n        self.padding = z.Padding(self.text.layout, padding_insets)\\n        self.centered = z.Aligned(self.padding.layout, axis='x', alignment='center' if centered else 'start')\\n        self.rectangle = z.Rectangle(hud=hud, color=self.background_color)\\n        self.stack = z.Stack([self.rectangle.layout, self.centered.layout])\\n        self.layout = self.stack.layout\\n\\n        self.focus = None\\n        self.focused = False\\n        self.focusable = focusable\\n\\n        self.hovered = False\\n\\n        if self.focusable:\\n            self.focus = focus_parent.add_child(self, on_changed=self.focus_changed)\\n\\n        world.apps['Hoverables'].add_hoverable(self)\\n\\n        self.clicked = z.Signal()\\n        self.right_clicked = z.Signal()\\n        self.double_clicked = z.Signal()\\n\\n        world.apps['Clickables'].register(self)\\n        world.apps['Clickables'].register_right_click(self)\\n        world.apps['Clickables'].register_double_click(self)\\n\\n    def on_click(self, f, i, d):\\n        if self.focusable:\\n            world.focus.set_focus(self.focus)\\n        self.clicked.emit(f, i, d)\\n\\n    def set_hud(self, hud):\\n        self.text.set_hud(hud)\\n        self.rectangle.set_hud(hud)\\n\\n    def on_right_click(self, f, i, d):\\n        if self.focusable:\\n            world.focus.set_focus(self.focus)\\n        self.right_clicked.emit(f, i, d)\\n\\n    def on_double_click(self, f, i, d):\\n        self.double_clicked.emit(f, i, d)\\n\\n    def set_color(self, color):\\n        self.background_color = np.asarray(color, float)\\n        self.update_colors()\\n\\n    def set_text(self, text):\\n        self.text.set_text(wrap_text(text, self.wrap) if self.wrap else text)\\n\\n    def intersect(self, ray):\\n        return self.rectangle.intersect(ray)\\n\\n    def update_colors(self):\\n        self.rectangle.set_color(world.themes.theme.focused_background_color \\\\\\n                                 if self.focused else adjust_perceptual_color_brightness(\\n                                     self.background_color, -0.2 if self.hovered else 0.0))\\n\\n    def focus_changed(self, focused):\\n        self.focused = focused\\n        self.update_colors()\\n        if focused:\\n            world.vim.modes['normal'].add_action_group(z.VimActionGroup('button', [\\n                        z.VimAction('submit', lambda: self.on_click(None, None, None), sdl2.SDLK_RETURN),\\n            ]))\\n        else:\\n            world.vim.modes['normal'].remove_action_group('button')\\n\\n    def on_hovered(self, entered):\\n        if entered:\\n            world.apps['SystemCursors'].set_cursor('hand')\\n        else:\\n            world.apps['SystemCursors'].set_cursor('arrow')\\n        self.hovered = entered\\n        self.update_colors()\\n\\n    def drop(self):\\n        world.apps['Hoverables'].remove_hoverable(self)\\n        world.apps['Clickables'].unregister(self)\\n        world.apps['Clickables'].unregister_right_click(self)\\n        world.apps['Clickables'].unregister_double_click(self)\\n        if self.focus:\\n            self.focus.disconnect()\\n        self.stack.drop()\\n        self.rectangle.drop()\\n        self.centered.drop()\\n        self.padding.drop()\\n        self.text.drop()\\n        if self.focus:\\n            self.focus.drop()\\n\", \"name\": \"Button\"}", "created_at": null, "updated_at": 1754736945.4792025}