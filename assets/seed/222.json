{"id": "222", "type": "class", "data": "{\"code_str\": \"import os\\nimport speech_recognition as sr\\n\\n\\nclass SpeechRecorder:\\n    def __init__(self, bluetooth=True):\\n        self.bluetooth = bluetooth\\n        self.recognizer = sr.Recognizer()\\n        if 'speech_recognizer/energy_threshold' in world.settings.values:\\n            self.recognizer.energy_threshold = float(world.settings.get_value('speech_recognizer/energy_threshold'))\\n        self.microphone = sr.Microphone()\\n\\n        self.device = 'cpu'\\n        if self.device == 'cpu':\\n            os.environ['OMP_NUM_THREADS'] = str(4)\\n            self.compute_type = 'int8'\\n        else:\\n            self.compute_type = 'float16'\\n        self.model = 'tiny.en' # for en: tiny, base, small, medium\\n\\n    def adjust_for_ambient_noise(self):\\n        if self.bluetooth:\\n            world.apps['BluetoothAudioManager'].switch_to_headset_profile()\\n        with self.microphone:\\n            self.recognizer.adjust_for_ambient_noise(self.microphone)\\n        world.settings.set_value('speech_recognizer/energy_threshold', str(self.recognizer.energy_threshold))\\n        if self.bluetooth:\\n            world.apps['BluetoothAudioManager'].switch_to_quality_profile()\\n\\n    def listen(self):\\n        if self.bluetooth:\\n            world.apps['BluetoothAudioManager'].switch_to_headset_profile()\\n        with self.microphone:\\n            audio = self.recognizer.listen(self.microphone)\\n        if self.bluetooth:\\n            world.apps['BluetoothAudioManager'].switch_to_quality_profile()\\n        return audio\\n\\n    def recognize(self, audio):\\n        value = self.recognizer.recognize_faster_whisper(\\n            audio, model=self.model, init_options=dict(device=self.device, compute_type=self.compute_type),\\n            show_dict=True, language='en', initial_prompt='')\\n        return value\\n\\n    def listen_and_recognize(self):\\n        v = self.recognize(self.listen())\\n        return v\\n\\n    def drop(self):\\n        pass\\n\", \"name\": \"SpeechRecorder\"}", "created_at": null, "updated_at": 1756754129.723843}