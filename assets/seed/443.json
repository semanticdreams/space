{"id": "443", "type": "class", "data": "{\"code_str\": \"class RRectangle:\\n    vertices = np.array([\\n        0, 0, 0,\\n        0, 0, 0, 1,\\n        0,\\n        0, 1, 0,\\n        0, 0, 0, 1,\\n        0,\\n        1, 1, 0,\\n        0, 0, 0, 1,\\n        0,\\n        1, 1, 0,\\n        0, 0, 0, 1,\\n        0,\\n        1, 0, 0,\\n        0, 0, 0, 1,\\n        0,\\n        0, 0, 0,\\n        0, 0, 0, 1,\\n        0,\\n    ], np.float32)\\n\\n    def __init__(self, color=(1, 0, 0, 1), position=(0, 0, 0), size=(10, 10),\\n                 rotation=(1, 0, 0, 0), depth_offset_index=0,\\n                 hidden=False, hud=False):\\n        self.color = np.asarray(color, float)\\n        self.rotation = np.asarray(rotation, float)\\n        self.position = np.asarray(position, float)\\n        self.depth_offset_index = depth_offset_index\\n        self.size = np.asarray(size, float)\\n        self.hidden = hidden\\n        self.hud = hud\\n        if self.hud:\\n            self.triangle_vector = world.renderers.hud_triangle_vector\\n        else:\\n            self.triangle_vector = world.renderers.scene_triangle_vector\\n        self.handle = self.triangle_vector.allocate(self.vertices.size)\\n        self.dirty = {'color', 'positions'}\\n\\n    def clone(self):\\n        return self.__class__(color=self.color, position=self.position, size=self.size,\\n                              rotation=self.rotation, hidden=self.hidden, hud=self.hud,\\n                              depth_offset_index=self.depth_offset_index)\\n\\n    def __mul__(self, value):\\n        return [self] + [self.clone() for _ in range(value - 1)]\\n\\n    __rmul__ = __mul__\\n\\n    def update_color(self):\\n        if 'color' in self.dirty:\\n            v = self.triangle_vector.view(self.handle)\\n            for i in range(0, v.size, 8):\\n                v[i+3:i+7] = self.color\\n            self.dirty.remove('color')\\n\\n    def update_positions(self):\\n        if 'positions' in self.dirty:\\n            v = self.triangle_vector.view(self.handle)\\n            rotation_matrix = transformations.quaternion_matrix(\\n                self.rotation)[:-1, :-1]\\n            size = np.array((self.size[0], self.size[1], 0))\\n            for i in range(0, v.size, 8):\\n                if self.hidden:\\n                    v[i:i+3] = np.array((0, 0, 0))\\n                else:\\n                    b = self.vertices[i:i+3]\\n                    v[i:i+3] = np.matmul(rotation_matrix, (size * b)) + self.position\\n                    v[i+7] = self.depth_offset_index\\n            self.dirty.remove('positions')\\n\\n    def aabb(self):\\n        v = self.triangle_vector.view(self.handle)\\n        #vertices = [v[0:3], v[7:10], v[14:17], v[21:24], v[28:31], v[35:38]]\\n        vertices = [v[0:3], v[8:11], v[16:19], v[24:27], v[32:36], v[40:43]]\\n        return np.array((np.amin(vertices, axis=0), np.amax(vertices, axis=0)))\\n\\n    def update(self):\\n        self.update_color()\\n        self.update_positions()\\n\\n    def set_color(self, color):\\n        self.color = np.asarray(color, float)\\n        self.dirty.add('color')\\n\\n    def set_depth_offset_index(self, depth_offset_index):\\n        self.depth_offset_index = depth_offset_index\\n        self.dirty.add('positions')\\n\\n    def set_position(self, position):\\n        self.position = np.asarray(position, float)\\n        self.dirty.add('positions')\\n\\n    def set_rotation(self, rotation):\\n        self.rotation = np.asarray(rotation, float)\\n        self.dirty.add('positions')\\n\\n    def set_size(self, size):\\n        self.size = np.asarray(size, float)\\n        self.dirty.add('positions')\\n\\n    def show(self):\\n        self.hidden = False\\n        self.dirty.add('positions')\\n\\n    def hide(self):\\n        self.hidden = True\\n        self.dirty.add('positions')\\n\\n    def drop(self):\\n        self.triangle_vector.delete(self.handle)\\n\", \"name\": \"RRectangle\"}", "created_at": null, "updated_at": 1754239007.4994526}