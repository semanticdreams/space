{"id": "a88f04b7-67dd-4d02-bdbc-9d611d0b71cd", "type": "class", "data": "{\"code_str\": \"class Workspace(z.Entity):\\n    def __init__(self, id, name, items):\\n        self.name = name\\n        self.items = items\\n        super().__init__('workspace', id)\\n        self.label = self.name\\n\\n        self.view = z.WorkspaceView\\n        self.preview = z.WorkspacePreview\\n        self.color = (0.2, 0.0, 0.7, 1)\\n\\n    def activate(self):\\n        if 'floaties' not in self.items:\\n            self.items['floaties'] = []\\n        for floatie_data in self.items['floaties']:\\n            if 'launcher_code_entity_id' in floatie_data:\\n                entity = world.apps['Entities'].get_entity(floatie_data['launcher_code_entity_id'])\\n                floatie = world.floaties.add(code_entity=entity)\\n            else:\\n                entity = world.apps['Entities'].get_entity(floatie_data['class_entity_id'])\\n                print('workspace: adding class entity as floatie:', entity.name)\\n                cls = entity.eval()\\n                floatie = world.floaties.add(cls())\\n            floatie.layout.position = np.array(floatie_data['position'])\\n        world.floaties.changed.connect(self.floaties_changed)\\n        if 'kernels' not in self.items:\\n            self.items['kernels'] = []\\n        print(self.items['kernels'])\\n        for kernel_data in self.items['kernels']:\\n            kernel = world.kernels[kernel_data['id']]\\n            kernel.start_kernel()\\n        world.kernels.changed.connect(self.kernels_changed)\\n\\n    def deactivate(self):\\n        world.floaties.changed.disconnect(self.floaties_changed)\\n        world.floaties.drop_all()\\n        world.kernels.changed.disconnect(self.kernels_changed)\\n        for id, kernel in world.kernels.kernels.items():\\n            if id != 0:\\n                kernel.stop_kernel()\\n                kernel.wait_for_kernel_stopped()\\n\\n    def floaties_changed(self):\\n        self.items['floaties'] = []\\n        for floatie in world.floaties.floaties.values():\\n            if floatie.code_entity:\\n                self.items['floaties'].append({\\n                    'launcher_code_entity_id': floatie.code_entity.id,\\n                    'position': floatie.layout.position.tolist()\\n                })\\n                continue\\n            cls = floatie.obj.__class__\\n            if util.has_mandatory_params(cls.__init__):\\n                warning = f'WARNING: {cls.__name__} not added to workspace'\\n                print(warning)\\n                world.apps['Hud'].snackbar_host.show_message(warning)\\n                continue\\n            class_entity = z.ClassEntity.find(cls.__name__)\\n            self.items['floaties'].append({\\n                'class_entity_id': class_entity.id,\\n                'position': floatie.layout.position.tolist()\\n            })\\n        self.save()\\n\\n    def kernels_changed(self):\\n        self.items['kernels'] = []\\n        for id, kernel in world.kernels.kernels.items():\\n            if id == 0:\\n                continue\\n            if kernel.status == 'started':\\n                self.items['kernels'].append({\\n                    'id': id\\n                })\\n        self.save()\\n\\n    @classmethod\\n    def create(cls, name='', items=None):\\n        items = items or {}\\n        data = {'name': name, 'items': items}\\n        id = super().create('workspace', data)\\n        return cls(id, name, items)\\n\\n    @classmethod\\n    def load(cls, id, data):\\n        return cls(id, data['name'], data.get('items', {}))\\n\\n    @classmethod\\n    def find(cls, name):\\n        workspaces = world.apps['Entities'].get_entities('workspace')\\n        matches = [x for x in workspaces if x.name == name]\\n        if matches:\\n            return matches[0]\\n        raise Exception(f'Workspace \\\"{name}\\\" not found.')\\n\\n    def dump_data(self):\\n        return {'name': self.name, 'items': self.items}\\n\\n    def clone(self):\\n        return Workspace.create(name=self.name, items=self.items)\\n\", \"name\": \"Workspace\"}", "created_at": null, "updated_at": 1756754129.729027}