{"id": "435", "type": "class", "data": "{\"code_str\": \"class GraphEntity(z.Entity):\\n    def __init__(self, id, nodes, edges, positions, force_layout_params):\\n        self.nodes = nodes  # list of entity_ids\\n        self.edges = edges  # list of dicts: {'source_id', 'target_id', 'label', 'meta_id'}\\n        self.positions = positions\\n        self.force_layout_params = force_layout_params\\n        super().__init__('graph', id)\\n\\n        self.view = z.GraphEntityView\\n        self.preview = z.GraphEntityPreview\\n\\n    @classmethod\\n    def create(cls):\\n        id = super().create('graph')\\n        return cls(id, [], [], {}, {})\\n\\n    @classmethod\\n    def load(cls, id, data):\\n        data['nodes'] = [str(x) for x in data['nodes']]\\n        data['edges'] = [{\\n            'source_id': str(x['source_id']),\\n            'target_id': str(x['target_id']),\\n            'meta_id': str(x['meta_id']),\\n            'label': x['label'],\\n        } for x in data['edges']]\\n        data['positions'] = {str(k): v for k, v in data.get('positions', {}).items()}\\n        return cls(id, data['nodes'], data['edges'],\\n                   data['positions'], data.get('force_layout_params', {}))\\n\\n    def dump_data(self):\\n        return {\\n            'nodes': self.nodes,\\n            'edges': self.edges,\\n            'positions': self.positions,\\n            'force_layout_params': self.force_layout_params,\\n        }\\n\\n    def add_node(self, entity, position=(0, 0, 0)):\\n        if entity.id not in self.nodes:\\n            self.nodes.append(entity.id)\\n            self.positions[entity.id] = position\\n\\n    def remove_node(self, entity_id):\\n        node_id = entity_id\\n        self.positions.pop(entity_id, None)\\n        self.nodes = [n for n in self.nodes if n != node_id]\\n        self.edges = [e for e in self.edges if e['source_id'] != node_id and e['target_id'] != node_id]\\n\\n    def has_node(self, entity):\\n        return entity.id in self.nodes\\n\\n    def add_edge(self, source_entity, target_entity, label=None, meta_entity=None):\\n        source_id = source_entity.id\\n        target_id = target_entity.id\\n        if source_id not in self.nodes:\\n            self.nodes.append(source_id)\\n        if target_id not in self.nodes:\\n            self.nodes.append(target_id)\\n\\n        self.edges.append({\\n            'source_id': source_id,\\n            'target_id': target_id,\\n            'label': label,\\n            'meta_id': meta_entity.id if meta_entity else None\\n        })\\n\\n    def remove_edge(self, source_entity, target_entity):\\n        source_id = source_entity.id\\n        target_id = target_entity.id\\n        self.edges = [e for e in self.edges if not (e['source_id'] == source_id and e['target_id'] == target_id)]\\n\\n    def has_edge(self, source_entity, target_entity):\\n        source_id = source_entity.id\\n        target_id = target_entity.id\\n        return any(e for e in self.edges if e['source_id'] == source_id and e['target_id'] == target_id)\\n\\n    def get_neighbors(self, entity):\\n        entity_id = entity.id\\n        return list(set(\\n            [e['target_id'] for e in self.edges if e['source_id'] == entity_id] +\\n            [e['source_id'] for e in self.edges if e['target_id'] == entity_id]\\n        ))\\n\\n    def get_outgoing(self, entity):\\n        entity_id = entity.id\\n        return [e for e in self.edges if e['source_id'] == entity_id]\\n\\n    def get_incoming(self, entity):\\n        entity_id = entity.id\\n        return [e for e in self.edges if e['target_id'] == entity_id]\\n\\n    def get_edge(self, source_entity, target_entity):\\n        source_id = source_entity.id\\n        target_id = target_entity.id\\n        for e in self.edges:\\n            if e['source_id'] == source_id and e['target_id'] == target_id:\\n                return e\\n        return None\\n\\n    def update_edge_meta(self, source_entity, target_entity, new_meta_entity):\\n        edge = self.get_edge(source_entity, target_entity)\\n        if edge:\\n            edge['meta_id'] = new_meta_entity.id if new_meta_entity else None\\n\\n    def clone(self):\\n        new_graph = GraphEntity.create()\\n        new_graph.nodes = list(self.nodes)\\n        new_graph.positions = dict(self.positions)\\n        new_graph.force_layout_params = self.force_layout_params.copy()\\n        new_graph.edges = [\\n            {\\n                'source_id': edge['source_id'],\\n                'target_id': edge['target_id'],\\n                'label': edge['label'],\\n                'meta_id': edge['meta_id']\\n            }\\n            for edge in self.edges\\n        ]\\n        return new_graph\\n\", \"name\": \"GraphEntity\"}", "created_at": null, "updated_at": 1754736945.469936}