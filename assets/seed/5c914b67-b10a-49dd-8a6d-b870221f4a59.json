{"id": "5c914b67-b10a-49dd-8a6d-b870221f4a59", "type": "shader", "data": "{\"name\": \"msdf.frag\", \"code_str\": \"#version 130\\n\\nin vec2 texCoord;\\nin vec4 fgColor;\\nflat in int depth_offset_index;\\n\\nout vec4 color;\\n\\nuniform sampler2D msdf;\\nuniform float pxRange;\\n\\nconst float depthStep = 1e-3;\\n\\nfloat screenPxRange() {\\n    vec2 unitRange = vec2(pxRange)/vec2(textureSize(msdf, 0));\\n    vec2 screenTexSize = vec2(1.0)/fwidth(texCoord);\\n    return max(0.5*dot(unitRange, screenTexSize), 1.0);\\n}\\n\\nfloat median(float r, float g, float b) {\\n    return max(min(r, g), min(max(r, g), b));\\n}\\n\\nvoid main() {\\n    vec3 msd = texture(msdf, texCoord).rgb;\\n    float sd = median(msd.r, msd.g, msd.b);\\n    float screenPxDistance = screenPxRange()*(sd - 0.5);\\n    float opacity = clamp(screenPxDistance + 0.5, 0.0, 1.0);\\n    color = vec4(fgColor.rgb * opacity, opacity);\\n    //color = vec4(fgColor.rgb, fgColor.a * opacity);\\n    //vec4 bgColor = vec4(0.0, 0.0, 1.0, 1.0);\\n    //color = mix(bgColor, fgColor, opacity);\\n\\tgl_FragDepth = max(0.0, gl_FragCoord.z - (gl_FragCoord.z * float(depth_offset_index) * depthStep));\\n}\"}", "created_at": 1751711944.1569874, "updated_at": 1751711944.1569874}