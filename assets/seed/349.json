{"id": "349", "type": "class", "data": "{\"code_str\": \"import os\\nfrom OpenGL.GL import *\\nimport numpy as np\\nfrom PIL import Image\\nfrom ctypes import sizeof, c_float, c_void_p, c_uint, string_at\\n\\n\\nbase_vertices = np.array([\\n    0, 0, 0,\\n    0, 1,\\n    0, 1, 0,\\n    0, 0,\\n    1, 1, 0,\\n    1, 0,\\n    1, 1, 0,\\n    1, 0,\\n    1, 0, 0,\\n    1, 1,\\n    0, 0, 0,\\n    0, 1\\n], np.float32)\\n\\n\\nclass Pic:\\n    def __init__(self, image=None, filename=None):\\n        self.layout = z.Layout(measurer=self.measurer, layouter=self.layouter, name='pic')\\n        self.vertices = None\\n\\n        if filename:\\n            image = Image.open(filename)\\n\\n        mode = GL_RGBA if image.mode == 'RGBA' else GL_RGB\\n\\n        self.image_size = image.size\\n        self.aspect = self.image_size[0] / self.image_size[1]\\n\\n        data = np.array(list(image.getdata()), 'B')\\n        #data = np.array(image, dtype=np.uint8)\\n        self.texture_id = glGenTextures(1)\\n        glBindTexture(GL_TEXTURE_2D, self.texture_id)\\n        glTexImage2D(GL_TEXTURE_2D, 0, mode, image.size[0], image.size[1],\\n                     0, mode, GL_UNSIGNED_BYTE, data)\\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR)\\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR)\\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE)\\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE)\\n        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_R, GL_CLAMP_TO_EDGE)\\n        glBindTexture(GL_TEXTURE_2D, 0)\\n\\n        world.renderers.pics.add_pic(self)\\n\\n    def measurer(self):\\n        base_size = 30\\n        self.layout.measure = np.array((base_size, base_size / self.aspect, 0))\\n\\n    def layouter(self):\\n        self.vertices = base_vertices.copy()\\n        rotation_matrix = transformations.quaternion_matrix(\\n            self.layout.rotation)[:-1, :-1]\\n        #size = np.array((self.layout.size[0], self.layout.size[1], 0))\\n        size = self.layout.measure\\n        for i in range(0, self.vertices.size, 5):\\n            b = self.vertices[i:i+3]\\n            self.vertices[i:i+3] = np.matmul(rotation_matrix, (size * b)) + self.layout.position\\n\\n    def drop(self):\\n        world.renderers.pics.remove_pic(self)\\n        self.layout.drop()\\n        glDeleteTextures([self.texture_id])\\n\", \"name\": \"Pic\"}", "created_at": null, "updated_at": 1756754129.7313864}