{"id": "163", "type": "class", "data": "{\"code_str\": \"import time\\nclass PomodoroIndicator:\\n    def __init__(self):\\n        self.button = z.ContextButton(label='pomodoro', color=(0.3, 0.6, 0.9, 0.9),\\n                                              focusable=False,\\n                                              hud=True,\\n                                              actions=[\\n                                                  ('toggle', self.toggle),\\n                                                  ('restart', self.start_new),\\n                                              ])\\n        world.hud.top_panel.add(self.button)\\n\\n        world.pomodoro.recover_sessions()\\n        self.current = world.pomodoro.get_most_recently_created_session()\\n        self.update()\\n\\n    def toggle(self):\\n        if self.current is None:\\n            self.start_new()\\n        else:\\n            if self.current['started_at']:\\n                self.stop()\\n            else:\\n                self.resume()\\n\\n    def update(self):\\n        self.button.set_label(\\n            str(round(self.current['duration'] - (self.current['elapsed'] + ((time.time() - self.current['started_at']) if self.current['started_at'] is not None else 0)))))\\n\\n    def refetch_session(self):\\n        self.current = world.pomodoro.get_session(self.current['id'])\\n        self.update()\\n\\n    def start_new(self):\\n        self.current = world.pomodoro.get_session(world.pomodoro.create_session())\\n        self.resume()\\n\\n    def resume(self):\\n        world.pomodoro.start_session(self.current['id'])\\n        self.interval = world.apps['Time'].set_interval(self.update, 1000)\\n        self.refetch_session()\\n\\n    def stop(self):\\n        self.interval.drop()\\n        world.pomodoro.stop_session(self.current['id'])\\n        self.refetch_session()\\n\\n    def drop(self):\\n        if self.current and self.current['started_at'] is not None:\\n            self.stop()\\n        world.hud.top_panel.remove(self.button)\\n\", \"name\": \"PomodoroIndicator\"}", "created_at": null, "updated_at": 1754239007.5019603}