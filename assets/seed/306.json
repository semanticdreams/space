{"id": "306", "type": "class", "data": "{\"code_str\": \"class ConsoleView:\\n    def __init__(self, console):\\n        self.console = console\\n        #self.console_view_vim_mode = z.ConsoleViewVimMode(self)\\n        self.focus = world.focus.add_child(obj=self, on_subtree_changed=self.on_focus_changed)\\n\\n        self.output = z.Input(focus_parent=self.focus, multiline=True, max_lines=30, min_lines=20)\\n        self.input = z.Input(focus_parent=self.focus, multiline=True, max_lines=3, min_lines=3)\\n        self.input.submitted.connect(self.input_submitted)\\n        self.column = z.Flex([z.FlexChild(self.output.layout),\\n                              z.FlexChild(self.input.layout),],\\n                             axis='y', xalign='largest')\\n\\n        self.layout = self.column.layout\\n\\n        self.update()\\n\\n        self.console.changed.connect(self.update)\\n\\n    def on_focus_changed(self, focused):\\n        pass\\n        #if focused:\\n        #    world.vim.add_mode(self.console_view_vim_mode)\\n        #    world.vim.modes['normal'].add_action_group(z.VimActionGroup('console', [\\n        #        z.VimAction('console', self.set_console_vim_mode, sdl2.SDLK_i),\\n        #    ]))\\n        #else:\\n        #    world.vim.modes['normal'].remove_action_group('console')\\n        #    world.vim.remove_mode('console')\\n\\n    #def set_console_vim_mode(self):\\n    #    world.vim._ignore_next_char = True\\n    #    world.vim.set_current_mode('console')\\n\\n    def input_submitted(self):\\n        self.console.write(self.input.text)\\n        self.console.ret()\\n        self.input.set_text('')\\n\\n    def update(self):\\n        text = '\\\\n'.join(self.console.cmdlines[-300:])\\n        text = textwrap.fill(text, tabsize=4, replace_whitespace=False, drop_whitespace=False)\\n        text = '\\\\n'.join(text.split('\\\\n')[-100:])\\n        self.output.set_text(text)\\n\\n    def drop(self):\\n        #world.vim.set_current_mode('normal')\\n        self.console.changed.disconnect(self.update)\\n        self.column.drop()\\n        self.input.drop()\\n        self.output.drop()\\n        self.focus.drop()\", \"name\": \"ConsoleView\"}", "created_at": null, "updated_at": 1754736945.459191}