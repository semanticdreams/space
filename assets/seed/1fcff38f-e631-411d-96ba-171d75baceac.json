{"id": "1fcff38f-e631-411d-96ba-171d75baceac", "type": "shader", "data": "{\"name\": \"triangle.frag\", \"code_str\": \"#version 330 core\\n\\nin vec4 thePosition;\\nsmooth in vec4 theColor;\\nflat in int depth_offset_index;\\nout vec4 fragColor;\\n\\nconst float depthStep = 1e-3;\\n\\nstruct DirLight {\\n    vec3 direction;\\n  \\n    vec3 ambient;\\n    vec3 diffuse;\\n    vec3 specular;\\n};  \\n\\nvec3 CalcDirLight(DirLight light, vec3 normal, vec3 viewDir)\\n{\\n    vec3 lightDir = normalize(-light.direction);\\n\\n    // Diffuse shading\\n    float diff = max(dot(normal, lightDir), 0.0);\\n\\n    // Specular shading\\n    vec3 reflectDir = reflect(-lightDir, normal);\\n    float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32); // 32 = material.shininess\\n\\n    // Combine results\\n    vec3 ambient  = light.ambient; \\n    vec3 diffuse  = light.diffuse  * diff;\\n    vec3 specular = light.specular * spec * 1.0f; // 0.5f = material.specular\\n    return (ambient + diffuse + specular);\\n}  \\n\\nuniform vec3 viewPos;\\nuniform DirLight dirLight;\\n\\nvoid main()\\n{  \\n\\tvec3 normal = normalize(cross(dFdy(thePosition.xyz), dFdx(thePosition.xyz)));\\n\\tvec3 viewDir = normalize(viewPos - thePosition.xyz);\\n\\n\\tvec3 light = CalcDirLight(dirLight, normal, -viewDir);\\n\\n\\tfragColor = vec4(light, 1.0f) * theColor;\\n\\tgl_FragDepth = max(0.0, gl_FragCoord.z - (gl_FragCoord.z * float(depth_offset_index) * depthStep));\\n}\"}", "created_at": 1751711944.073006, "updated_at": 1751711944.073006}