{"id": "164", "type": "class", "data": "{\"code_str\": \"import os\\nimport json\\nimport asyncio\\nfrom lib.requests import requests\\nclass Hackernews:\\n    def __init__(self):\\n        self.baseurl = 'https://hacker-news.firebaseio.com/v0/'\\n        self.items = {}\\n\\n        self.data_folder = os.path.join(world.datadir, 'hackernews')\\n        os.makedirs(self.data_folder, exist_ok=True)\\n\\n        self.items_folder = os.path.join(self.data_folder, 'items')\\n        os.makedirs(self.items_folder, exist_ok=True)\\n        self.saved_stories_path = os.path.join(self.data_folder, 'saved-stories.json')\\n\\n    async def get_item(self, id):\\n        if id in self.items:\\n            return self.items[id]\\n        item_filename = os.path.join(self.items_folder, '{}.json'.format(id))\\n        if os.path.exists(item_filename):\\n            with open(item_filename) as f:\\n                item = json.load(f)\\n                self.items[id] = item\\n                return item\\n        url = self.baseurl + 'item/{}.json'.format(id)\\n        response = await requests.get(url)\\n        item = await response.json()\\n        self.items[id] = item\\n        with open(item_filename, 'w') as f:\\n            json.dump(item, f)\\n        return item\\n\\n    async def get_items(self, ids):\\n        return await asyncio.gather(*[self.get_item(id) for id in ids])\\n\\n    async def get_stories(self, category):\\n        assert category in ('topstories', 'newstories', 'beststories')\\n        url = self.baseurl + f'{category}.json'\\n        response = await requests.get(url)\\n        item_ids = await response.json()\\n        return await self.get_items(item_ids)\\n\\n    async def get_story_comments(self, story):\\n        kids_ids = story.get('kids', [])\\n        return await self.get_items(kids_ids)\\n\\n    async def save_story(self, story_id):\\n        path = self.saved_stories_path\\n        if os.path.isfile(path):\\n            with open(path) as f:\\n                saved = set(json.load(f))\\n        else:\\n            saved = set()\\n        saved.add(story_id)\\n        with open(path, 'w') as f:\\n            json.dump(list(saved), f)\\n\\n    async def get_saved_stories(self):\\n        with open(self.saved_stories_path) as f:\\n            ids = json.load(f)\\n        return await self.get_items(ids)\\n\", \"name\": \"Hackernews\"}", "created_at": null, "updated_at": 1754239007.5060182}