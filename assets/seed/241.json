{"id": "241", "type": "class", "data": "{\"code_str\": \"class Rectangle(z.Droppable):\\n    vertices = np.array([\\n        0, 0, 0,\\n        0, 0, 0, 1,\\n        0,\\n        0, 1, 0,\\n        0, 0, 0, 1,\\n        0,\\n        1, 1, 0,\\n        0, 0, 0, 1,\\n        0,\\n        1, 1, 0,\\n        0, 0, 0, 1,\\n        0,\\n        1, 0, 0,\\n        0, 0, 0, 1,\\n        0,\\n        0, 0, 0,\\n        0, 0, 0, 1,\\n        0,\\n    ], np.float32)\\n\\n    def __init__(self, color=(1, 0, 0, 1), hud=False):\\n        super().__init__()\\n        self.dropped = False\\n        self.color = np.asarray(color)\\n        self.hud = hud\\n        if self.hud:\\n            self.triangle_vector = world.renderers.hud_triangle_vector\\n        else:\\n            self.triangle_vector = world.renderers.scene_triangle_vector\\n        self.handle = self.triangle_vector.allocate(self.vertices.size)\\n\\n        self.hidden = False\\n\\n        self.layout = z.Layout(measurer=self.measurer, layouter=self.layouter, name='rectangle')\\n\\n        self.dirty = {'color'}\\n\\n    def set_hud(self, hud):\\n        if hud != self.hud:\\n            self.triangle_vector.delete(self.handle)\\n            self.handle = None\\n            if hud:\\n                self.triangle_vector = world.renderers.hud_triangle_vector\\n            else:\\n                self.triangle_vector = world.renderers.scene_triangle_vector\\n            self.handle = self.triangle_vector.allocate(self.vertices.size)\\n            self.hud = hud\\n\\n    def clone(self):\\n        return self.__class__(color=self.color, hud=self.hud)\\n\\n    def __mul__(self, value):\\n        return [self] + [self.clone() for _ in range(value - 1)]\\n\\n    def measurer(self):\\n        self.measure = np.array((0, 0, 0), float)\\n\\n    def layouter(self):\\n        self.update_color()\\n        v = self.triangle_vector.view(self.handle)\\n        rotation_matrix = transformations.quaternion_matrix(\\n            self.layout.rotation)[:-1, :-1]\\n        size = np.array((self.layout.size[0], self.layout.size[1], 0))\\n        for i in range(0, v.size, 8):\\n            if self.hidden:\\n                v[i:i+3] = np.array((0, 0, 0))\\n            else:\\n                b = self.vertices[i:i+3]\\n                v[i:i+3] = np.matmul(rotation_matrix, (size * b)) + self.layout.position\\n                v[i+7] = self.layout.depth_offset_index\\n\\n    def aabb(self):\\n        v = self.triangle_vector.view(self.handle)\\n        vertices = [v[0:3], v[8:11], v[16:19], v[24:27], v[32:36], v[40:43]]\\n        return np.array((np.amin(vertices, axis=0), np.amax(vertices, axis=0)))\\n\\n    def intersect(self, ray):\\n        return self.layout.intersect(ray)\\n\\n    def update_color(self):\\n        if 'color' in self.dirty:\\n            v = self.triangle_vector.view(self.handle)\\n            for i in range(0, v.size, 8):\\n                v[i+3:i+7] = self.color\\n            self.dirty.remove('color')\\n\\n    def set_color(self, color):\\n        self.color = np.asarray(color, float)\\n        self.dirty.add('color')\\n        self.layout.mark_layout_dirty()\\n\\n    def show(self):\\n        self.hidden = False\\n        self.layout.mark_layout_dirty()\\n\\n    def hide(self):\\n        self.hidden = True\\n        self.layout.mark_layout_dirty()\\n\\n    def drop(self):\\n        self.layout.drop()\\n        self.triangle_vector.delete(self.handle)\\n        self.dropped = True\\n\", \"name\": \"Rectangle\"}", "created_at": null, "updated_at": 1756754129.7287326}