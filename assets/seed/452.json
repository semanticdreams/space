{"id": "452", "type": "class", "data": "{\"code_str\": \"class CodeEntityView:\\n    def __init__(self, entity, focus_parent=None):\\n        self.focus = (focus_parent or world.focus).add_child(self)\\n        self.entity = entity\\n\\n        self.actions_panel = z.ActionsPanel([\\n            ('run code', self.run_code),\\n            ('paste code', self.paste_code),\\n            ('edit name', self.edit_name),\\n            ('edit language', self.edit_lang),\\n            ('edit kernel', self.edit_kernel),\\n            ('copy entity', self.entity.copy),\\n            ('clone', self.clone_code),\\n            ('archive', self.archive_code),\\n            ('delete', self.delete_code),\\n        ], focus_parent=self.focus)\\n\\n        self.name_input = z.Input(self.entity.name, focus_parent=self.focus)\\n        self.name_input.submitted.connect(self.name_input_submitted)\\n\\n        self.code_input = z.Input(self.entity.code_str, multiline=True,\\n                                  tabs=True, focus_parent=self.focus,\\n                                  min_lines=3, max_lines=10, syntax_coloring=True)\\n        self.code_input.submitted.connect(self.code_input_submitted)\\n\\n        self.column = z.Flex([\\n            z.FlexChild(self.actions_panel.layout),\\n            z.FlexChild(self.name_input.layout),\\n            z.FlexChild(self.code_input.layout, flex=1)\\n        ], axis='y', xalign='largest')\\n\\n        self.layout = self.column.layout\\n\\n    def code_input_submitted(self):\\n        self.entity.set_code_str(self.code_input.text)\\n        self.entity.save()\\n\\n    def name_input_submitted(self):\\n        self.entity.name = self.name_input.text\\n        self.entity.save()\\n\\n    def __str__(self):\\n        return f'{self.entity}, [name={self.entity.name}, lang={self.entity.lang}, kernel={self.entity.kernel}]'\\n\\n    def paste_code(self):\\n        assert Y.register_type == 'entity'\\n        entity = Y.value\\n        assert entity.type == 'code'\\n        new_code_str = '\\\\n'.join((self.code_input.text, entity.code_str))\\n        self.code_input.set_text(new_code_str)\\n        self.code_input_submitted()\\n\\n    def run_code(self):\\n        self.entity.run()\\n\\n    def edit_name(self):\\n        input = z.Input(self.entity.name)\\n        def on_submitted():\\n            new_name = input.text.strip()\\n            if new_name != self.entity.name:\\n                self.entity.name = new_name\\n                self.entity.save()\\n        input.submitted.connect(on_submitted)\\n        world.floaties.add(input)\\n\\n    def edit_lang(self):\\n        input = z.Input(self.entity.lang)\\n        def on_submitted():\\n            new_lang = input.text.strip()\\n            if new_lang != self.entity.lang:\\n                self.entity.lang = new_lang\\n                self.entity.save()\\n        world.floaties.add(input)\\n\\n    def edit_kernel(self):\\n        input = z.Input(str(self.entity.kernel) if self.entity.kernel else '')\\n        def on_submitted():\\n            new_kernel = input.text.strip()\\n            if new_kernel:\\n                new_kernel = int(new_kernel)\\n                if new_kernel != self.entity.kernel:\\n                    self.entity.kernel = new_kernel\\n                    self.entity.save()\\n        world.floaties.add(input)\\n\\n    def clone_code(self):\\n        cloned = self.entity.clone()\\n        world.floaties.add(cloned.view(cloned))\\n\\n    def archive_code(self):\\n        self.entity.archive()\\n\\n    def delete_code(self):\\n        self.entity.delete()\\n\\n    def drop(self):\\n        self.column.drop()\\n        self.actions_panel.drop()\\n        self.name_input.drop()\\n        self.code_input.drop()\\n        self.focus.drop()\\n\", \"name\": \"CodeEntityView\"}", "created_at": null, "updated_at": 1756754129.7241848}