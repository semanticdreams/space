{"id": "323", "type": "class", "data": "{\"code_str\": \"class ObjectSelector:\\n    def __init__(self):\\n        self.selectables = []\\n        self.selected = []\\n\\n        self.exited = z.Signal()\\n        self.changed = z.Signal()\\n\\n        self.box_selector = z.BoxSelector()\\n        self.box_selector.changed.connect(self.on_box_changed)\\n        self.box_selector.exited.connect(self.exited.emit)\\n\\n    def is_active(self):\\n        return self.box_selector.active\\n\\n    def set_selectables(self, objs):\\n        prev_selected = set(self.selected)\\n        self.selected = prev_selected & set(objs)\\n        self.selectables = objs\\n        if prev_selected != self.selected:\\n            self.changed.emit()\\n        self.selected = list(self.selected)\\n\\n    def add_selectables(self, objs):\\n        self.selectables.extend(objs)\\n\\n    def remove_selectables(self, objs):\\n        for obj in objs:\\n            self.selectables.remove(obj)\\n        prev_selected = set(self.selected)\\n        self.selected = prev_selected & set(self.selectables)\\n        if prev_selected != self.selected:\\n            self.changed.emit()\\n        self.selected = list(self.selected)\\n\\n    def unselect_all(self):\\n        self.selected = []\\n        self.changed.emit()\\n\\n    def set_selected(self, selected, emit_changed=True):\\n        self.selected = selected\\n        if emit_changed:\\n            self.changed.emit()\\n\\n    def on_box_changed(self, box):\\n        unproject = world.unproject\\n        p1, p2 = box\\n\\n        b_top = unproject((p1[0], p1[1], 1.0)) \\\\\\n                - unproject((p1[0], p1[1], 0.0))\\n        c_top = unproject((p2[0], p1[1], 1.0)) \\\\\\n                - unproject((p1[0], p1[1], 0.0))\\n        b_bottom = unproject((p1[0], p2[1], 1.0)) \\\\\\n                - unproject((p1[0], p2[1], 0.0))\\n        c_bottom = unproject((p2[0], p2[1], 1.0)) \\\\\\n                - unproject((p1[0], p2[1], 0.0))\\n        b_left = b_bottom\\n        c_left = unproject((p1[0], p1[1], 1.0)) \\\\\\n                - unproject((p1[0], p2[1], 0.0))\\n        b_right = unproject((p2[0], p1[1], 1.0)) \\\\\\n                - unproject((p2[0], p1[1], 0.0))\\n        c_right = unproject((p2[0], p2[1], 1.0)) \\\\\\n                - unproject((p2[0], p1[1], 0.0))\\n\\n        selected = []\\n\\n        for selectable in self.selectables:\\n            x_top = selectable.layout.position - unproject((p1[0], p1[1], 0.0))\\n            x_bottom = selectable.layout.position - unproject((p1[0], p2[1], 0.0))\\n            x_left = selectable.layout.position - unproject((p1[0], p2[1], 0.0))\\n            x_right = selectable.layout.position - unproject((p2[0], p1[1], 0.0))\\n\\n            det_top = np.linalg.det(np.array([b_top, c_top, x_top]))\\n            det_bottom = np.linalg.det(np.array([b_bottom, c_bottom, x_bottom]))\\n\\n            if np.sign(det_top) == np.sign(det_bottom):\\n                continue\\n\\n            det_left = np.linalg.det(np.array([b_left, c_left, x_left]))\\n            det_right = np.linalg.det(np.array([b_right, c_right, x_right]))\\n\\n            if np.sign(det_left) != np.sign(det_right):\\n                continue\\n\\n            selected.append(selectable)\\n        self.set_selected(selected)\\n\\n    def on_mouse_button(self, button, action, mods):\\n        self.box_selector.on_mouse_button(button, action, mods)\\n\\n    def on_mouse_motion(self, x, y):\\n        self.box_selector.on_mouse_motion(x, y)\\n\\n    def on_keyboard(self, key, scancode, action, mods):\\n        self.box_selector.on_keyboard(key, scancode, action, mods)\\n\\n    def drop(self):\\n        pass\\n\", \"name\": \"ObjectSelector\"}", "created_at": null, "updated_at": 1754239007.5024602}