{"id": "22c025ae-a446-4c91-91bf-3ff9364429ee", "type": "class", "data": "{\"code_str\": \"class CreateEntityTypeView:\\n    def __init__(self, focus_parent=None):\\n        self.focus = (focus_parent or world.focus).add_child(self)\\n\\n        self.name_input = z.Input(focus_parent=self.focus)\\n        self.submit_button = z.Button('submit', focus_parent=self.focus)\\n        self.submit_button.clicked.connect(self.on_submit_clicked)\\n        self.row = z.Flex([\\n            z.FlexChild(self.name_input.layout, flex=1),\\n            z.FlexChild(self.submit_button.layout)\\n        ], yalign='largest')\\n        self.layout = self.row.layout\\n\\n    def on_submit_clicked(self, f, i, d):\\n        name = self.name_input.text\\n        assert name, name\\n        entity_cls_name = f'{name}Entity'\\n        if entity_cls_name in world.classes.names:\\n            raise Exception(f'Entity class {entity_cls_name} exists')\\n        view_cls_name = f'{entity_cls_name}View'\\n        preview_cls_name = f'{entity_cls_name}Preview'\\n        color = util.random_color()\\n        entity_type_name = util.camel_to_hyphen(name)\\n        code_str = f\\\"\\\"\\\"class {entity_cls_name}(z.Entity):\\n    def __init__(self, id, value):\\n        super().__init__('{entity_type_name}', id)\\n        self.value = value\\n        self.view = z.{view_cls_name}\\n        self.preview = z.{preview_cls_name}\\n        self.color = {color.tolist()}\\n\\n    @classmethod\\n    def create(cls, value=None, id=None):\\n        id = super().create('{entity_type_name}', value, id=id)\\n        return cls(id, value)\\n\\n    @classmethod\\n    def load(cls, id, data):\\n        return cls(id, data)\\n\\n    def clone(self):\\n        return {entity_cls_name}.create(value=self.value)\\n\\n    def dump_data(self):\\n        return self.value\\n\\\"\\\"\\\"\\n        view_code_str = f\\\"\\\"\\\"class {view_cls_name}:\\n    def __init__(self, entity, focus_parent=None):\\n        self.focus = (focus_parent or world.focus).add_child(self)\\n        self.entity = entity\\n\\n        self.actions_panel = z.ActionsPanel([\\n            ('copy entity', self.entity.copy),\\n            ('delete', self.entity.delete),\\n        ], focus_parent=self.focus)\\n\\n        self.column = z.Flex([\\n            z.FlexChild(self.actions_panel.layout),\\n        ], axis='y', xalign='largest')\\n\\n        self.layout = self.column.layout\\n\\n    def drop(self):\\n        self.column.drop()\\n        self.actions_panel.drop()\\n        self.focus.drop()\\n\\\"\\\"\\\"\\n        preview_code_str = f\\\"\\\"\\\"class {preview_cls_name}:\\n    def __init__(self, entity, focus_parent=None):\\n        self.entity = entity\\n        self.button = z.ContextButton(\\n            label='{entity_type_name}',\\n            focus_parent=focus_parent,\\n            max_lines=1,\\n            font_scale=5,\\n            actions=[\\n                ('view', lambda: world.floaties.add(\\n                    self.entity.view(self.entity))),\\n            ]\\n        )\\n        self.layout = self.button.layout\\n\\n    def drop(self):\\n        self.button.drop()\\n\\\"\\\"\\\"\\n        cls_entity = z.ClassEntity.create(name=entity_cls_name, code_str=code_str)\\n        view_entity = z.ClassEntity.create(name=view_cls_name, code_str=view_code_str)\\n        preview_entity = z.ClassEntity.create(\\n            name=preview_cls_name, code_str=preview_code_str)\\n        G.add_node(cls_entity)\\n        G.add_node(view_entity)\\n        G.add_node(preview_entity)\\n        G.add_edge(cls_entity, view_entity)\\n        G.add_edge(cls_entity, preview_entity)\\n        G.add_edge(z.ClassEntity.find('Entities'), cls_entity)\\n        G.add_edge(z.Entity.get('f403458d-968a-4818-8740-433413527e3f'), view_entity)\\n        G.add_edge(z.Entity.get('7dea25a5-7c49-4e82-9f0b-3830ececfd4b'), preview_entity)\\n        G.save()\\n\\n    def drop(self):\\n        self.row.drop()\\n        self.name_input.drop()\\n        self.submit_button.drop()\\n        self.focus.drop()\\n\", \"name\": \"CreateEntityTypeView\"}", "created_at": 1753172671.5995517, "updated_at": 1754736945.4944153}