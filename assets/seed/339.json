{"id": "339", "type": "class", "data": "{\"code_str\": \"from collections import defaultdict\\n\\n\\nclass Vector:\\n    __slots__ = ('array', 'freed', 'free_from')\\n\\n    def __init__(self, size=0):\\n        self.array = np.zeros(size, np.float32)\\n        self.freed = defaultdict(list)\\n        self.free_from = 0\\n\\n    def resize(self, size):\\n        if size > self.array.size:\\n            self.array.resize(size)\\n        elif size < self.array.size:\\n            raise ValueError(\\\"Manual downsizing is not supported.\\\")\\n\\n    def view(self, handle):\\n        return self.array[handle.index:handle.index+handle.size]\\n\\n    def allocate(self, size):\\n        # Reuse freed\\n        if handles := self.freed[size]:\\n            handle = handles.pop()\\n            return handle\\n        index = self.free_from\\n        if self.free_from + size <= self.array.size:\\n            self.free_from += size\\n            return z.VectorHandle(index, size)\\n        self.array.resize(2 * self.array.size - self.free_from + size, refcheck=False)\\n        self.free_from += size\\n        return z.VectorHandle(index, size)\\n\\n    def delete(self, handle):\\n        self.zero(handle)\\n        self.freed[handle.size].append(handle)\\n\\n    def zero(self, handle):\\n        self.array[handle.index:handle.index+handle.size] = \\\\\\n                np.zeros(handle.size)\\n\\n    def reallocate(self, handle, new_size):\\n        if new_size < handle.size:\\n            start = handle.index + new_size\\n            end = handle.index + handle.size\\n            self.array[start:end] = 0\\n        elif new_size > handle.size:\\n            self.delete(handle)\\n            handle = self.allocate(new_size)\\n        return handle\\n\", \"name\": \"Vector\"}", "created_at": null, "updated_at": 1754239007.503389}